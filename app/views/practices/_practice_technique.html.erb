<%= div_for(practice_technique, :practice_technique_id => practice_technique.id, :class => practice_technique.technique.technique_type.symbol) do %>
  <h3 class='<%= 'long' if practice_technique.technique.name.size > 27 %>'><%= practice_technique.technique.name %></h3>
  <div class='front'>
    <%= image_tag practice_technique.technique.photo.url(:thumb) %>
  </div>
  <div class='back'>
    <ul class='actions'>
      <li class='ui-state-default ui-corner-all'><%= link_to( content_tag(:span, 'edit', :class => 'ui-icon ui-icon-pencil'), '#', :id => 'edit_link') %></li>
      <li class='ui-state-default ui-corner-all'><%= link_to( content_tag(:span, 'delete', :class => 'ui-icon ui-icon-trash'), '#', :id => 'delete_link') %></li>
    </ul>
    <ul class='associated_techniques'>
    <% practice_technique.techniques.each do |technique| %>
      <li class='associated-technique'>
        <%= technique.name %>
        <span class='associated-technique-actions'><span class='ui-state-default ui-corner-all'><%= link_to_function(content_tag(:span, '(-)', :class => 'ui-icon ui-icon-circle-minus'), "
        $('#confirm_dialog').dialog({
        resizable: false,
        height:140,
        modal: true,
        buttons: {
          'Delete': function() {
          $.ajax({
              type:'put',
              data: { 'practice_technique[remove_technique_id]': #{technique.id} },
              dataType: 'script',
              url: '#{practice_practice_technique_path(practice_technique.practice, practice_technique)}'});
          $(this).dialog('close');
          },
          Cancel: function() {
            $(this).dialog('close');
          }
        }
      });") %></span></span>
      </li>
    <% end %>
    </ul>
  </div>
<% end %>

<%= javascript_tag do %>
  $('#<%= dom_id practice_technique %>').droppable({
  accept: '.mudra',
  drop: function(event, ui) {
    if(ui.draggable.hasClass('ui-draggable')) {
      // associate new practice technique via ajax
      $.ajax({
          type: 'put',
          data: 'practice_id=<%= practice_technique.practice.id-%>&id=' + $(this).attr('practice_technique_id') + '&practice_technique[add_technique_id]=' + ui.draggable.attr('technique_id'),
          dataType: 'script',
          url: '/practices/<%= practice_technique.practice.id-%>/practice_techniques/' + $(this).attr('practice_technique_id')});
    }
  }
});
<% end %>